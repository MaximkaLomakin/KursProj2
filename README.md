# Веб-приложение Погода на React.js

Веб-приложение для просмотра погоды с системой авторизации и админ-панелью.

## Технологии

### Frontend
- React.js с create-react-app
- Redux Toolkit для управления состоянием
- React Router для навигации
- CSS Modules для стилизации
- Jest и React Testing Library для тестирования
- Reselect для мемоизированных селекторов
- Immutable.js для иммутабельных структур данных
- React Portals для модальных окон

### Backend
- Node.js с Express
- JWT для аутентификации
- OpenWeatherMap API для получения данных о погоде
- bcryptjs для хэширования паролей
- JSON файлы для хранения данных (пользователи, избранное, популярные запросы)

## Установка и запуск

### Backend

1. Перейдите в папку backend:
```bash
cd backend
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` на основе `.env.example` и укажите ваш API ключ OpenWeatherMap:
```
PORT=5000
JWT_SECRET=секретный_ключ_для_разработки
OPENWEATHER_API_KEY=ваш_ключ_от_openweathermap
```

4. Запустите сервер:
```bash
npm start
```

Сервер будет доступен по адресу http://localhost:5000

**Примечание:** При первом запуске автоматически создается администратор (username: `admin`, password: `admin123`)

### Frontend

1. Установите зависимости:
```bash
npm install
```

2. Создайте файл `.env` и укажите URL API:
```
API_URL=http://localhost:5000/api
```

3. Запустите приложение:
```bash
npm start
```

Приложение будет доступно по адресу http://localhost:3000

## Тестирование

Для запуска тестов:
```bash
cd frontend
npm test
```

Для проверки линтера:
```bash
npm run lint
```

## Функциональность

### Для всех пользователей
- **Просмотр погоды** - можно просматривать погоду без регистрации
- **Поиск погоды по городу** - введите название города в строку поиска
- **Текущая погода** - температура, описание, влажность, скорость ветра, давление
- **Почасовой прогноз** - слайдер с прогнозом на ближайшие 24 часа с детальной информацией
- **Прогноз на 5 дней** - прогноз с разбивкой по периодам дня (утро, день, вечер, ночь)
- **Выбор единиц измерения** - возможность выбрать единицы для скорости ветра (м/с, км/ч, миль/ч) и давления (hPa, мм рт.ст., дюймы рт.ст.)
- **Темная/светлая тема** - переключение между темами с сохранением в localStorage

### Для авторизованных пользователей
- **Регистрация и вход** - модальные окна для регистрации и авторизации
- **Избранные города** - добавление городов в избранное и быстрый доступ к ним
- **Список избранных городов** - отображается под строкой поиска

### Для администраторов
- **Админ-панель** - доступна по пути `/admin`
- **Управление пользователями:**
  - Просмотр списка всех пользователей
  - Просмотр детальной информации о пользователе (клик по строке)
  - Редактирование пользователя (имя, email, роль, пароль) через модальное окно
  - Удаление пользователей
- **Популярные запросы:**
  - Просмотр списка популярных запросов погоды с количеством запросов
  - Обнуление запросов для конкретного города
  - Обнуление всех популярных запросов
- **Статистика:**
  - Общее количество зарегистрированных пользователей
  - Общее количество запросов погоды

## Структура проекта

```
├── project/
│   ├── backend/
│   │   ├── server.js              # Основной файл сервера
│   │   ├── data/                  # JSON файлы для хранения данных
│   │   │   ├── users.json         # Пользователи
│   │   │   ├── favorites.json     # Избранные города
│   │   │   └── popularRequests.json # Популярные запросы
│   │   ├── package.json
│   │   └── .env.example
│   ├── src/
│   │   ├── components/        # React компоненты
│   │   │   ├── DailyForecast/      # Прогноз на 5 дней
│   │   │   ├── FavoritesList/      # Список избранных городов
│   │   │   ├── Footer/             # Футер
│   │   │   ├── HourlyForecastSlider/ # Почасовой прогноз
│   │   │   ├── LoginModal/         # Модальное окно входа
│   │   │   ├── Navigation/         # Навигация
│   │   │   ├── PopularRequests/     # Популярные запросы
│   │   │   ├── RegisterModal/      # Модальное окно регистрации
│   │   │   ├── UnitsSelector/      # Выбор единиц измерения
│   │   │   ├── UserModal/          # Модальное окно пользователя
│   │   │   ├── UsersList/           # Список пользователей
│   │   │   ├── WeatherCard/        # Карточка погоды
│   │   │   └── WeatherIcon/        # Иконки погоды (SVG)
│   │   ├── pages/              # Страницы приложения
│   │   │   ├── AdminPanel/    # Админ-панель
│   │   │   └── HomePage/      # Главная страница
│   │   ├── store/             # Redux store
│   │   │   ├── slices/       # Redux slices
│   │   │   │   ├── authSlice.js      # Авторизация
│   │   │   │   ├── favoritesSlice.js # Избранное
│   │   │   │   ├── themeSlice.js     # Тема
│   │   │   │   ├── unitsSlice.js     # Единицы измерения
│   │   │   │   └── weatherSlice.js   # Погода
│   │   │   ├── selectors/    # Селекторы
│   │   │   └── middleware/   # Middleware
│   │   ├── hooks/            # Кастомные хуки
│   │   ├── utils/            # Утилиты
│   │   └── App.js
│   └── package.json
└── README.md
```

## API Endpoints

### Авторизация
- `POST /api/register` - регистрация нового пользователя
- `POST /api/login` - вход в систему

### Погода
- `GET /api/weather?city=Москва` - получение данных о погоде (авторизация не обязательна)

### Избранное (требует авторизации)
- `GET /api/favorites` - получение списка избранных городов
- `POST /api/favorites` - добавление города в избранное
- `DELETE /api/favorites` - удаление города из избранного

### Админ-панель (требует роль admin)
- `GET /api/admin/users` - список всех пользователей
- `PUT /api/admin/users/:id` - редактирование пользователя (имя, email, роль, пароль)
- `DELETE /api/admin/users/:id` - удаление пользователя
- `GET /api/admin/popular-requests` - популярные запросы погоды
- `DELETE /api/admin/popular-requests?city=Москва` - обнуление запросов для города (без параметра - обнуление всех)
- `GET /api/admin/statistics` - статистика (количество пользователей и запросов)

## Учетные данные по умолчанию

Администратор создается автоматически при первом запуске:
- **Логин:** `admin`
- **Пароль:** `admin123`


BSTU CourseWork 2, FIT-2. Korchuganov Maxim
